# LearnThai 管理后台设计

## 概述

为 LearnThai 应用添加完整的管理后台，包括词汇管理、用户管理和学习数据分析仪表板。

## 架构

### 路由结构

```
/admin/                  # 仪表板（统计概览 + 图表）
/admin/vocabulary        # 词汇列表（分页、搜索、筛选）
/admin/vocabulary/add    # 添加词汇
/admin/vocabulary/<id>   # 编辑/删除词汇
/admin/users             # 用户列表（分页）
/admin/users/<id>        # 查看用户详情/禁用
```

### 权限控制

- 所有 `/admin/*` 路由需要登录 + `is_admin=True`
- 非管理员访问返回 403 或重定向到首页

### 文件结构

```
app/routes/admin.py              # 管理路由
app/templates/admin/
├── base_admin.html              # 管理后台基础模板（侧边栏导航）
├── dashboard.html               # 仪表板
├── vocabulary_list.html         # 词汇列表
├── vocabulary_form.html         # 添加/编辑词汇表单
├── user_list.html               # 用户列表
└── user_detail.html             # 用户详情
```

## 仪表板

### 顶部数字卡片（4个）

- 总用户数 / 今日新增
- 总词汇数 / 已启用
- 今日活跃用户
- 总答题次数 / 今日答题

### 图表区域

1. **每日活跃趋势（折线图）**
   - 最近 7 天每日活跃用户数
   - 使用简单 CSS/JS 实现，不引入重型图表库

2. **词汇掌握率分布（柱状图）**
   - 按熟悉度等级(0-5)统计用户词汇数
   - 显示每个等级的词汇占比

3. **排行榜（表格）**
   - 困难词汇 TOP 5（错误率最高）
   - 热门词汇 TOP 5（被学习次数最多）

### 技术方案

- 图表用纯 CSS + 少量 JS 实现（无需 Chart.js）
- 统计查询在后端完成，传给模板渲染

## 词汇管理

### 词汇列表页面

- 分页显示（每页 20 条）
- 搜索框：按泰语词/中文释义搜索
- 筛选：按分类、难度等级、状态（启用/禁用）
- 表格列：泰语词、中文释义、分类、难度、状态、操作

### 添加/编辑表单字段

| 字段 | 必填 | 说明 |
|------|------|------|
| 泰语词 | ✓ | thai_word |
| 中文释义 | ✓ | chinese_meaning |
| 发音 | | pronunciation |
| 分类 | | 下拉选择或输入 |
| 难度等级 | | 1-5 下拉 |
| 例句（泰语） | | 文本框 |
| 例句（中文） | | 文本框 |
| 是否启用 | | 复选框，默认启用 |

### 操作

- 编辑：跳转到编辑表单
- 删除：弹窗确认后删除（软删除：设为禁用）
- 批量导入：保留现有 CSV 导入功能入口

## 用户管理

### 用户列表页面

- 分页显示（每页 20 条）
- 搜索框：按用户名/邮箱搜索
- 表格列：用户名、邮箱、注册时间、最后登录、学习词汇数、状态、操作

### 用户详情页面

- 基本信息：用户名、邮箱、注册时间、最后登录
- 学习统计：
  - 已学词汇数 / 已掌握词汇数
  - 总答题次数 / 正确率
  - 最近 7 天学习情况
- 操作按钮：
  - 禁用/启用账户
  - 重置为普通用户 / 设为管理员

### 模型修改

需要在 User 模型添加 `is_active` 字段（默认 True），禁用用户无法登录。

## 界面风格

### 布局

```
┌─────────────────────────────────────────────┐
│  LearnThai 管理后台          [用户名] [登出] │
├──────────┬──────────────────────────────────┤
│          │                                  │
│  侧边栏   │         内容区域                 │
│          │                                  │
│  仪表板   │                                  │
│  词汇管理 │                                  │
│  用户管理 │                                  │
│          │                                  │
│  返回前台 │                                  │
│          │                                  │
└──────────┴──────────────────────────────────┘
```

### 样式

- 复用现有 CSS 变量和按钮样式
- 侧边栏深色背景，与前台区分
- 表格使用斑马纹，便于阅读
- 响应式：移动端侧边栏可折叠

### 管理员入口

在前台导航栏，管理员用户显示「管理后台」链接。
