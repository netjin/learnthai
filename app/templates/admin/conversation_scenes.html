{% extends "admin/base_admin.html" %}

{% block title %}对话场景管理 - 管理后台{% endblock %}

{% block content %}
<div class="admin-header">
    <h1>对话场景管理</h1>
    <a href="{{ url_for('admin.conversation_scene_add') }}" class="btn btn-primary">添加场景</a>
</div>

<div class="admin-content">
    {% if scenes %}
    <table class="admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>图标</th>
                <th>场景名称</th>
                <th>泰语名称</th>
                <th>难度</th>
                <th>排序</th>
                <th>对话数</th>
                <th>状态</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for scene in scenes %}
            <tr>
                <td>{{ scene.id }}</td>
                <td style="font-size: 1.5rem;">{{ scene.icon }}</td>
                <td><strong>{{ scene.name_chinese }}</strong></td>
                <td class="thai-text">{{ scene.name_thai }}</td>
                <td>
                    <span class="badge badge-level-{{ scene.difficulty_level }}">
                        {{ '★' * scene.difficulty_level }}
                    </span>
                </td>
                <td>{{ scene.sort_order }}</td>
                <td>{{ scene.conversation_count }}</td>
                <td>
                    {% if scene.is_active %}
                    <span class="badge badge-success">启用</span>
                    {% else %}
                    <span class="badge badge-secondary">禁用</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('admin.conversation_list', scene_id=scene.id) }}"
                        class="btn btn-sm btn-info">查看对话</a>
                    <a href="{{ url_for('admin.conversation_scene_edit', id=scene.id) }}"
                        class="btn btn-sm btn-secondary">编辑</a>
                    <form method="POST" action="{{ url_for('admin.conversation_scene_toggle', id=scene.id) }}"
                        style="display:inline;">
                        <button type="submit" class="btn btn-sm btn-warning">
                            {{ '禁用' if scene.is_active else '启用' }}
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>暂无对话场景</p>
        <a href="{{ url_for('admin.conversation_scene_add') }}" class="btn btn-primary">添加第一个场景</a>
    </div>
    {% endif %}
</div>

<style>
    .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .admin-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .admin-table th,
    .admin-table td {
        padding: 1rem;
        text-align: left;
        border-bottom: 1px solid #ecf0f1;
    }

    .admin-table th {
        background: #f8f9fa;
        font-weight: 600;
        color: #2c3e50;
    }

    .admin-table tr:hover {
        background: #f8f9fa;
    }

    .thai-text {
        font-family: 'Sarabun', 'Noto Sans Thai', sans-serif;
        color: #3498db;
    }

    .badge {
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.85rem;
        font-weight: 500;
    }

    .badge-success {
        background: #d4edda;
        color: #155724;
    }

    .badge-secondary {
        background: #e2e3e5;
        color: #6c757d;
    }

    .badge-level-1 {
        background: #d4edda;
        color: #155724;
    }

    .badge-level-2 {
        background: #d1ecf1;
        color: #0c5460;
    }

    .badge-level-3 {
        background: #fff3cd;
        color: #856404;
    }

    .badge-level-4 {
        background: #f8d7da;
        color: #721c24;
    }

    .badge-level-5 {
        background: #f5c6cb;
        color: #721c24;
    }

    .btn-sm {
        padding: 0.25rem 0.75rem;
        font-size: 0.875rem;
    }

    .btn-info {
        background: #17a2b8;
        color: white;
    }

    .btn-info:hover {
        background: #138496;
    }

    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: white;
        border-radius: 8px;
    }
</style>
{% endblock %}